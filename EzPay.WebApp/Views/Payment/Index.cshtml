@model LoginViewModel

@{
	ViewData["Title"] = "Payment";
}

<div class="container">
	<div class="col-xs-12 col-sm-6 col-sm-offset-3">
		<table class="table table-striped table-hover">
			@{ var BillsDetail = Model.Bills.FirstOrDefault(); }
			<thead>
				<tr>
					<th>@Html.DisplayNameFor(model => BillsDetail.DueDate)</th>
					<th>@Html.DisplayNameFor(model => BillsDetail.Description)</th>
					<th>@Html.DisplayNameFor(model => BillsDetail.Amount)</th>
				</tr>
			</thead>
			<tbody>
				@foreach (var item in Model.Bills)
			{

					<tr>
						<td>
							@Html.DisplayFor(modelItem => item.DueDate)
						</td>
						<td>
							@Html.DisplayFor(modelItem => item.Description)
						</td>
						<td>
							@Html.DisplayFor(modelItem => item.Amount)
							<i class="fa fa-eur" aria-hidden="true"></i>
						</td>
					</tr>

			}
			</tbody>
		</table>
	</div>
</div>

<form asp-controller="Payment" asp-action="Pay"  asp-route-id="@BillsDetail.Id" method="post" class="form-horizontal">

	<div class="form-group">
		<label for="cardno" class="sr-only">Card Number:</label>
		<div class="col-xs-12 col-sm-6 col-sm-offset-3">
			<div class="input-group">
				<input type="number" value="" onsubmit="if(valid_credit_card(value)==false) error(" Not valid card number.")" class="form-control" name="cardno" id="cardno" placeholder="Enter your Card No." />
				<span class="input-group-addon"><i class="fa fa-credit-card" aria-hidden="true"></i></span>
			</div>
		</div>
	</div>

	<div class="form-group">

		<label for="CardIssuer" class="sr-only">Card Issuer</label>
		<div class="col-xs-12 col-sm-4 col-sm-offset-3">
			<div class="input-group">
				<span class="input-group-addon"><i class="fa fa-university" aria-hidden="true"></i></span>
				<select class="form-control" id="CardIssuer">
					<option>VISA<i class="fa fa-cc-visa" aria-hidden="true"></i></option>
					<option>Mastercard</option>
					<option>Maestro</option>
					<option>American Express</option>
					<option>Diners</option>
				</select>
			</div>
		</div>

		<label for="cvv2" class="sr-only">CVV2:</label>
		<div class="col-xs-6 col-sm-2 mtop15-mob">
			<div class="input-group">
				<span class="input-group-addon"><i class="fa fa-hashtag" aria-hidden="true"></i></span>
				<input type="number" maxlength="3" class="form-control" name="cvv2" id="cvv2" placeholder="CVV" />
			</div>
		</div>

	</div>

	<div class="form-group">
		<div class="col-xs-12 col-sm-6 col-sm-offset-3">
			<button type="submit" class="btn btn-primary col-xs-12 col-sm-12 lc">Pay your bill</button>
		</div>
	</div>

<script>
	function valid_credit_card(value) {
		// accept only digits, dashes or spaces
		if (/[^0-9-\s]+/.test(value)) return false;

		// The Luhn Algorithm. It's so pretty.
		var nCheck = 0, nDigit = 0, bEven = false;
		value = value.replace(/\D/g, "");

		for (var n = value.length - 1; n >= 0; n--) {
			var cDigit = value.charAt(n),
				nDigit = parseInt(cDigit, 10);

			if (bEven) {
				if ((nDigit *= 2) > 9) nDigit -= 9;
			}

			nCheck += nDigit;
			bEven = !bEven;
		}

		return (nCheck % 10) == 0;
	}
</script>
</form>
