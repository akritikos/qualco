@model EzPay.WebApp.Models.LoginViewModel

@{
	ViewData["Title"] = "Welcome";
}

<div class="container">
	<div class="col-sm-6 col-sm-offset-3">
		<table class="table table-striped table-hover">
			@{ var BillsDetail = Model.Bills.FirstOrDefault(); }
			<thead>
				<tr>
					<th>@Html.DisplayNameFor(model => BillsDetail.DueDate)</th>
					<th>@Html.DisplayNameFor(model => BillsDetail.Description)</th>
					<th>@Html.DisplayNameFor(model => BillsDetail.Amount)</th>
				</tr>
			</thead>
			<tbody>
				@foreach (var item in Model.Bills)
				{
					<tr>
						<td>
							@Html.DisplayFor(modelItem => item.DueDate)
						</td>
						<td>
							@Html.DisplayFor(modelItem => item.Description)
						</td>
						<td>
							@Html.DisplayFor(modelItem => item.Amount)
							<i class="fa fa-eur" aria-hidden="true"></i>
						</td>
					</tr>

				}
			</tbody>
		</table>
	</div>
</div>

@{var TotalAmount = Model.Bills.Sum(c => c.Amount);}

<center><h2>Total amount @TotalAmount</h2></center>

<form asp-controller="SettlementDetails" asp-action="SubmitSettlement" method="post">
	@for (int i = 0; i < Model.Bills.Count(); i++)
	{
		<input asp-for="@Model.BillsList[i].CitizenId" type="hidden" />
		<input asp-for="@Model.BillsList[i].Id" type="hidden" />
		<input asp-for="@Model.BillsList[i].DueDate" type="hidden" />
		<input asp-for="@Model.BillsList[i].Description" type="hidden" />
		<input asp-for="@Model.BillsList[i].Amount" type="hidden" />
	}

	<center>
		<div class="container">
			<div class="dropdown">
				Downpayment:
				<select asp-for="@Model.SettlementTypeSelected" onchange="DownpaymentChange(value)">
					<option value="0">Choose downpayment</option>
					@foreach (var type in Model.SettlementTypes)
					{
						<option value=@type.Id>@(Decimal.Round(((type.Downpayment * TotalAmount) / (decimal)100.00), 2)) </option>
					}
				</select>
			</div>
		</div>
	



	<script>
		function DownpaymentChange(value) {
			//var type = 'Model.SettlementTypes.Where(c => c.Id == value)';
			//var maxInst = type.MaxInstallments.toString();
			document.getElementById("rangeInstInput").max = maxInst;
			document.getElementById("rangeInstInput").min = "3";
			document.getElementById("rangeInst").value = "0";
			document.getElementById("rangeInstInput").value = "0";
		}

	</script>


		<div class="container">
			<div class="row">
				<div class="col-sm-6 col-sm-offset-3">
					<h2>Installments</h2>
					<div class="range">
						<input asp-for="InstallmentsSelected" id="rangeInstInput" type="range" min="0" max="0" step="3" value="0" onchange="rangeInst.value=value">
						<output id="rangeInst">0</output>
					</div>
				</div>
			</div>
		</div>


		<button class="btn btn-warning lc" type="submit">Submit</button>
	</center>
</form>



